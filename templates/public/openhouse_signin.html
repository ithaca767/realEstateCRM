{% extends "base.html" %}
{% block body_class %}openhouse-public{% endblock %}

{% block title %}Open House Sign In{% endblock %}

{% block content %}
<div class="container mt-4" style="max-width: 820px;">

  <!-- Branding -->
  <div class="mb-3">
    <img
      src="{{ url_for('static', filename='branding/openhouse-logo.webp') }}"
      alt="Heritage House Sotheby’s International Realty"
      style="max-width: 300px; width: 100%; height: auto;"
    >
  </div>

  <hr style="border-top: 1px solid rgba(153,153,153,0.5);">

<div class="d-flex align-items-start gap-3 mb-3">

  <div>
    <h3 class="mb-1">Open House Sign In</h3>
    <div class="text-muted">
      {{ openhouse["address_line1"] }},
      {{ openhouse["city"] }},
      {{ openhouse["state"] }} {{ openhouse["zip"] }}
    </div>
  </div>

  {% if openhouse["house_photo_url"] %}
    <img
      src="{{ openhouse["house_photo_url"] }}"
      alt="House photo"
      style="width: 200px; height: auto;"
      class="rounded ms-auto"
    >
  {% endif %}

</div>

<div
  style="
    background: rgba(153,153,153,0.12);
    border: 1px solid rgba(153,153,153,0.35);
    border-radius: 12px;
    padding: 24px;
  "
>

  <form method="POST">
    <div class="row g-2">
      <div class="col-md-6">
        <label class="form-label">First Name</label>
        <input name="first_name" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label class="form-label">Last Name</label>
        <input name="last_name" class="form-control" required>
      </div>
    </div>

    <div class="row g-2 mt-1">
      <div class="col-md-6">
        <label class="form-label">Email</label>
        <input name="email" type="email" class="form-control">
      </div>
      <div class="col-md-6">
        <label class="form-label">Phone</label>
        <input name="phone" class="form-control">
      </div>
    </div>

    <div class="mt-3">
      <label class="form-label">Are you currently working with an agent?</label>
      <select name="working_with_agent" id="working_with_agent" class="form-select">
        <option value="">Select</option>
        <option value="no">No</option>
        <option value="yes">Yes</option>
      </select>
    </div>

<div id="agent_fields" class="rounded p-3 mt-2" style="display:none; border: 1px solid rgba(153,153,153,0.35);">
      <div class="row g-2">
        <div class="col-md-6">
          <label class="form-label">Agent Name</label>
            <input
              name="agent_name"
              id="agent_name"
              class="form-control"
            >

        </div>
        <div class="col-md-6">
          <label class="form-label">Agent Phone</label>
          <input name="agent_phone" class="form-control">
        </div>
      </div>
      <div class="mt-2">
        <label class="form-label">Agent Brokerage</label>
        <input name="agent_brokerage" class="form-control">
      </div>
    </div>

    <!-- Optional bullets must be below the agent question -->
    <div class="mt-3">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="looking_to_buy" id="looking_to_buy">
        <label class="form-check-label" for="looking_to_buy">I am looking to buy</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="looking_to_sell" id="looking_to_sell">
        <label class="form-check-label" for="looking_to_sell">I am looking to sell</label>
      </div>

      <div class="mt-2">
        <label class="form-label">Timeline</label>
        <select name="timeline" class="form-select">
          <option value="">Select</option>
          <option value="0-3 months">0-3 months</option>
          <option value="3-6 months">3-6 months</option>
          <option value="6-12 months">6-12 months</option>
          <option value="12+ months">12+ months</option>
        </select>
      </div>

      <div class="mt-2">
        <label class="form-label">Notes</label>
        <textarea name="notes" class="form-control" rows="3"></textarea>
      </div>
    </div>

    <div class="form-check mt-3">
      <input class="form-check-input" type="checkbox" name="consent_to_contact" id="consent_to_contact" checked>
      <label class="form-check-label" for="consent_to_contact">
        It is OK to contact me about this property and similar opportunities.
      </label>
    </div>

    <button class="btn btn-success mt-3 w-100" type="submit">Sign In</button>
  </form>
</div> <!-- end gray panel -->

<div class="openhouse-footer-legal">
  <a class="openhouse-legal-link" href="{{ url_for('open_house_privacy') }}">
    Privacy Notice and Terms of Use
  </a>

  <div class="openhouse-sothebys-disclosure">
    Sotheby's International Realty® and the Sotheby's International Realty logo are service marks licensed to Sotheby's International Realty Affiliates LLC and used with permission. Heritage House Sotheby's International Realty fully supports the principles of the Fair Housing Act and the Equal Opportunity Act. Each office is independently owned and operated. If your property is listed with a real estate broker, please disregard. It is not our intention to solicit the offerings of other real estate brokers.
  </div>
</div>

</div> <!-- end container -->

<script>
  const sel = document.getElementById("working_with_agent");
  const box = document.getElementById("agent_fields");
  const agentName = document.getElementById("agent_name");

  function toggleAgentFields() {
    if (sel.value === "yes") {
      box.style.display = "block";
      agentName.setAttribute("required", "required");
    } else {
      box.style.display = "none";
      agentName.removeAttribute("required");
      agentName.value = "";
    }
  }

  sel.addEventListener("change", toggleAgentFields);
  toggleAgentFields();
</script>
{% endblock %}
